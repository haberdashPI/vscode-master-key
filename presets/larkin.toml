[header]
version = "1.0"
requiredExtensions = [
      "dbankier.vscode-quick-select",
      "haberdashPI.vscode-select-by-indent",
      "haberdashPI.selection-utilities",
      "haberdashPI.move-cursor-by-argument",
      "pustelto.bracketeer",
      "wmaurer.change-case",
      "pranshuagrawal.toggle-case",
      "albymor.increment-selection",
      "pkief.markdown-checkbox",
      "edgardmessias.clipboard-manager",
      "stkb.rewrap",
      "haberdashPI.terminal-polyglot",
      "jack89ita.open-file-from-path",
      "koalamer.labeled-bookmarks",
]

name = "Larkin Key Bindings"
description = """
This set of keybindings provides a comprehensive and well tested set of
bindings that I use in my daily work. It serves as an example of a fully
customized set of keybindings, and demonstrates the full capabilities of
master-key.

The basic logic of these commands are inspired by kakoune: motions generally
cause some region of text to be selected, and then actions modify these
selections. This is the inverse of vim's motions (`wd` instead of `dw`). This
integrates well with many of the existing VSCode extensions which operate on
selections. It differs somewhat from kakoune in that most motions
extend the current selection, and space resets the selection.

These bindings are named after the middle name of my first child (Larkin).
"""

[define]
validModes = ["insert", "capture", "normal", "syminsert", "selectedit"]
select_on = false
around_on = false

[[define.selectLinesDown]]
command = "selection-utilities.shrinkToActive"

[[define.selectLinesDown]]
if = "count"
command = "cursorMove"
args = { to = "down", by = "wrappedLine", select = true }
computedArgs = { value = "count" }

[[define.selectLinesDown]]
command = "expandLineSelection"

[[define.selectLinesUp]]
command = "selection-utilities.shrinkToActive"

[[define.selectLinesUp]]
if = "count"
command = "cursorMove"
args = { to = "up", by = "wrappedLine", select = true }
computedArgs = { value = "count" }

[[define.selectLinesUp]]
command = "expandLineSelection"


[[path]]
id = "modes"
name = "Modes"
description = """
Larkin uses different modes (like vim). Insert is the default and it
works the same way VSCode normally does. Upon hitting escape you enter normal
mode, wherein a variety of behaviors are available to move around and manipulate the
text.

Refer to the actions section for the various ways you can exit normal mode and
return to insert mode.

**TODO**: document the other modes
"""
default.kind = "mode"

[[bind]]
path = "modes"
name = "normal"
description = "Enter normal mode"
key = ["escape", "ctrl+["]
command = "runCommands"
args = ["master-key.enterNormal", "master-key.reset"]
when = "!findWidgetVisible"
prefixes = "<all-prefixes>"

[[bind]]
path = "modes"
key = ["escape", "ctrl+["]
when = "suggsetWidgetVisible && editorTextFocus && !findWidgetVisible"
command = "runCommands"
args = ["master-key.enterNormal", "master-key.reset"]
prefixes = "<all-prefixes>"

[[bind]]
path = "modes"
# by default typing keys in a mode other than insert (or capture) is simply ignored
name = "ignore"
description = "this key does nothing"
key = ["<all-keys>", "shift+<all-keys>"]
command = "master-key.ignore"
prefixes = "<all-prefixes>"
mode = ["!insert", "!capture"]
when = "editorTextFocus"

[[path]]
id = "edit"
name = "Editor Commands"
description = """
Most commands are editing commands, they interact with the text editor, either by
selecting text in the editor, moving around it, manipulating text in the editor, and
so forth. There must be an active editor for these commands to work.
"""
default.when = "editorTextFocus && !findWidgetVisible"
default.mode = "normal"

[[path]]
id = "edit.count"
name = "count"
description = """
The number keys are used to update the count, which affects how many times the next
command is repeated, when relevant.
"""
default.kind = "count"

[[bind]]
path = "edit.count"
# likewise, the numbers affect command count in all modes where text isn't
# being entered
name = "Update number with {key}"
key = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9"]
command = "master-key.updateCount"
args.value = "{key}"
resetTransient = false
mode = ["!insert", "!capture"]

[[path]]
id = "edit.motion"
name = "Motions"
description = "Commands that move the cursors and/or selections"
default.kind = "select"

[[path]]
id = "edit.motion.prim"
name = "Primitive Motions"
description = "Motions fundamental to moving around in the editor."
default.command = "cursorMove"
default.computedArgs.value = "count"
default.computedArgs.around = "around_on"
default.computedArgs.select = "editorHasSelection || select_on"

[[bind]]
path = "edit.motion.prim"
key = "h"
name = "←"
description = "move left"
args.to = "left"
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.motion.prim"
key = "j"
name = "↓"
description = "move down"
args.to = "down"
args.by = "wrappedLine"

[[bind]]
path = "edit.motion.prim"
key = "k"
name = "↑"
description = "move up"
args.to = "up"
args.by = "wrappedLine"

[[bind]]
path = "edit.motion.prim"
key = "l"
name = "→"
description = "move right"
args.to = "right"
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.motion.prim"
key = "g j"
name = "unwrp ↓"
description = "down unwrapped line"
args.to = "down"
args.by = "line"

[[bind]]
path = "edit.motion.prim"
key = "g k"
name = "unwrp ↑"
description = "up unwrapped line"
args.to = "down"
args.by = "line"

[[bind]]
path = "edit.motion.prim"
key = "shift+h"
name = "start"
description = "start of line (alternates between first non-white and first)"
command = "cursorHomeSelect"

[[bind]] # we don't use prim because we don't want the defaults
path = "edit.motion"
key = "shift+l"
name = "end"
description = "end of line"
command = "cursorMove"
args.to = "wrappedLineEnd"
args.select = true

[[bind]]
path = "edit.motion.prim"
key = "shift+g"
name = "exapnd"
description = "expand selections to full lines"
command = "expandLineSelection"

[[bind]]
path = "edit.motion.prim"
key = "shift+k"
name = "sel ↑"
description = "select lines upwards"
command = "runCommands"

[[bind.args]]
command = "selection-utilities.shrinkToActive"

[[bind.args]]
command = "cursorMove"
args = { to = "up", by = "wrappedLine", select = true }
computedArgs = { value = "count" }

[[bind.args]]
command = "expandLineSelection"

[[bind]]
path = "edit.motion.prim"
key = "shift+j"
name = "sel ↓"
description = "select lines downwards"
command = "runCommands"

[[bind.args]]
command = "selection-utilities.shrinkToActive"

[[bind.args]]
command = "cursorMove"
args = { to = "down", by = "wrappedLine", select = true }
computedArgs = { value = "count" }

[[bind.args]]
command = "expandLineSelection"

[[bind]]
path = "edit.motion.prim"
key = "g shift+k"
name = "unwrp sel ↑"
description = "select unwrapped lines upwards"
command = "runCommands"

[[bind.args]]
command = "selection-utilities.shrinkToActive"

[[bind.args]]
command = "cursorMove"
args = { to = "up", by = "line", select = true }
computedArgs = { value = "count" }

[[bind.args]]
command = "expandLineSelection"

[[bind]]
path = "edit.motion.prim"
key = "g shift+j"
name = "sel ↓"
description = "select unwrapped lines downwards"
command = "runCommands"

[[bind.args]]
command = "selection-utilities.shrinkToActive"

[[bind.args]]
command = "cursorMove"
args = { to = "down", by = "line", select = true }
computedArgs = { value = "count" }

[[bind.args]]
command = "expandLineSelection"

[[bind]]
path = "edit.motion.prim"
key = '\'
name = "→ sel"
description = "select *just* the character to the right"
mode = ["normal", "selectedit"]
command = "runCommands"

[[bind.args]]
command = "selection-utilities.shrinkToActive"

[[bind.args]]
command = "cursorMove"
args = { to = "right", select = true }
computedArgs = { value = "count" }

[[bind]]
path = "edit.motion.prim"
key = 'shift+\'
name = "← sel"
description = "select *just* the character to the left"
mode = ["normal", "selectedit"]
command = "runCommands"

[[bind.args]]
command = "selection-utilities.shrinkToActive"

[[bind.args]]
command = "cursorMove"
args = { to = "left", select = true }
computedArgs = { value = "count" }

[[bind]]
path = "edit.motion.prim"
key = "g shift+g"
name = "doc end"
description = "select to end of document"
command = "cursorBottomSelect"

[[bind]]
path = "edit.motion.prim"
key = "g g"
name = "doc start"
description = "select to start of document"
command = "cursorTopSelect"

[[path]]
id = "edit.motion.mod"
name = "Modify Motion Effects"
description = "Keys that change how other motions work"
default.kind = "select"

[[bind]]
path = "edit.motion.mod"
key = "u"
name = "around"
description = """
selection commands are changed to both move start and end of a selection to surround the
entire object (rather than extending to specified start/end point)
"""
kind = "prefix"
resetTransient = false
mode = ["normal", "selectedit"]
command = "master-key.prefix"
args = { flag = "around_on" }

[[bind]]
path = "edit.motion.mod"
key = "shift+space"
name = "hold selection"
description = """
selection commands extend the selection
"""
command = "master-key.set"
args.name = "select_on"
args.value = true
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.motion.mod"
key = "space"
name = "shrink selection"
mode = ["normal", "selectedit"]
description = """
reduce all selections to length zero
"""
command = "runCommands"
args = [
      "selection-utilities.shrinkToActive",
      { command = "master-key.set", args = { name = "select_on", value = false } },
]

[[path]]
id = "edit.motion.obj"
name = "Motions around various regex-like objects"
description = """
selection commands that move by a predefined syntactic object (e.g. word, paragraph, etc...)
"""
default.command = "selection-utilities.moveBy"
default.args.boundary = "start"
default.prefixes = ["", "u"]
default.computedArgs.select = "!around_on"
default.computedArgs.selectWhole = "around_on"
default.mode = ["normal", "selectedit"]

[[bind]]
path = "edit.motion.obj"
key = "w"
name = "subwrd →"
description = "next subword (camel/snake case)"
args.unit = "subword"
computedArgs.value = "count || 1"

[[bind]]
path = "edit.motion.obj"
key = "e"
name = "subwrd end"
description = "next subword (camel/snake case) end"
args.unit = "subword"
computedArgs.boundary = "around_on ? 'both' : 'end'"
computedArgs.value = "count || 1"

[[bind]]
path = "edit.motion.obj"
key = "shift+w"
name = "word →"
description = "next word"
args.unit = "word"
computedArgs.value = "count || 1"

[[bind]]
path = "edit.motion.obj"
key = "shift+e"
name = "word end"
description = "next word end"
args.unit = "word"
computedArgs.boundary = "around_on ? 'both' : 'end'"
computedArgs.value = "count || 1"

[[bind]]
path = "edit.motion.obj"
key = "b"
name = "subwrd ←"
description = "previous subword (camel/snake case)"
args.unit = "subword"
computedArgs.value = "-count || -1"

[[bind]]
path = "edit.motion.obj"
key = "shift+b"
name = "word ←"
description = "previous word"
args.unit = "word"
computedArgs.value = "-count || -1"

[[bind]]
path = "edit.motion.obj"
key = "' w"
name = "WORD →"
description = "next WORD; e.g. contiguous non-whitespace region"
args.unit = "WORD"
computedArgs.value = "count || 1"

[[bind]]
path = "edit.motion.obj"
key = "' b"
name = "WORD ←"
description = "previous WORD; e.g. contiguous non-whitespace region"
args.unit = "WORD"
computedArgs.value = "-count || -1"

[[bind]]
path = "edit.motion.obj"
key = "' e"
name = "WORD end →"
description = "next WORD end; e.g. contiguous non-whitespace region"
args.unit = "WORD"
computedArgs.boundary = "around_on ? 'both' : 'end'"
computedArgs.value = "-count || -1"

[[bind]]
path = "edit.motion.obj"
key = "shift+2"
name = "number ←"
description = "previous number"
args.unit = "integer"
args.boundary = "both"
args.selectWhole = true
computedArgs = { value = "-(count || 1)" }

[[bind]]
path = "edit.motion.obj"
key = "shift+3"
name = "number →"
description = "next number"
args.unit = "integer"
args.boundary = "both"
args.selectWhole = true
computedArgs = { value = "(count || 1)" }

[[bind]]
path = "edit.motion.obj"
key = "' ;"
name = "comment ←"
description = "previous comment"
args.unit = "comment"
args.boundary = "both"
args.selectWhole = true
computedArgs = { value = "-(count || 1)" }

[[bind]]
path = "edit.motion.obj"
key = "' shift+;"
name = "comment →"
description = "next comment"
args.unit = "comment"
args.boundary = "both"
args.selectWhole = true
computedArgs = { value = "-(count || 1)" }

[[bind]]
path = "edit.motion.obj"
key = "/ ;"
name = "blk cmnt ←"
description = "previous block comment"
args.unit = "block_comment"
args.boundary = "both"
args.selectWhole = true
computedArgs = { value = "-(count || 1)" }

[[bind]]
path = "edit.motion.obj"
key = "/ shift+;"
name = "blk cmnt →"
description = "next block comment"
args.unit = "block_comment"
args.boundary = "both"
args.selectWhole = true
computedArgs = { value = "-(count || 1)" }

[[bind]]
path = "edit.motion.obj"
key = "p"
name = "paragraph →"
description = "next paragraph"
args.unit = "paragraph"
computedArgs.value = "count || 1"

[[bind]]
path = "edit.motion.obj"
key = "shift+p"
name = "paragraph ←"
description = "previous paragraph"
args.unit = "paragraph"
computedArgs.value = "-(count || 1)"

[[bind]]
path = "edit.motion.obj"
key = "shift+0"
name = "subsec →"
description = "next subsection"
args.unit = "subsection"
computedArgs.value = "count || 1"

[[bind]]
path = "edit.motion.obj"
key = "shift+9"
name = "subsec ←"
description = "previous subsection"
args.unit = "subsection"
computedArgs.value = "-(count || 1)"

[[bind]]
path = "edit.motion.obj"
key = "' shift+0"
name = "sec →"
description = "next seciont"
args.unit = "section"
computedArgs.value = "count || 1"

[[bind]]
path = "edit.motion.obj"
key = "' shift+p"
name = "sec ←"
description = "previous seciont"
args.unit = "section"
computedArgs.value = "-(count || 1)"

# TODO: add various iterations of notebook cell navigation

[[bind]]
path = "edit.motion.obj"
key = "shift+4"
name = "all"
description = "Select entire document"
command = "editor.action.selectAll"

[[bind]]
path = "edit.motion.obj"
key = "u u"
prefixes = [""]
name = "smart expand"
description = "Use VSCode's built-in smart expansion command"
command = "editor.action.smartSelect.expand"

[[path]]
id = "edit.motion.search"
name = "Search Related Motions"
description = "Motions related to searching for text in a document"
default.command = "master-key.search"
default.args.caseSensitive = true
default.args.backwards = false
default.args.selectTillMatch = true
default.args.wrapAround = true

[[bind]]
path = "edit.motion.search"
key = "/ /"
name = "capture"
description = "search forwards"
args.offset = "start"
args.register = "search"

[[bind]]
path = "edit.motion.search"
key = "shift+/"
name = "search bk"
description = "search backwards"
args.offset = "start"
args.register = "search"
args.backwards = true

[[bind]]
path = "edit.motion.search"
key = "n"
name = "→ search"
description = "Go to the next match of the search query"
command = "master-key.nextMatch"
args.register = "search"

[[bind]]
path = "edit.motion.search"
key = "shift+n"
name = "← search"
description = "Go to the previous match of the search query"
command = "master-key.previousMatch"
args.register = "search"

[[bind]]
path = "edit.motion.search"
key = "shift+8"
name = "match →"
description = "Next match to object under curosr"
computedArgs.text = "firstSelectionOrWord"
args.offset = "start"
args.register = "search"
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.motion.search"
key = "shift+7"
name = "match ←"
description = "Previous match to object under curosr"
computedArgs.text = "firstSelectionOrWord"
args.offset = "start"
args.register = "search"
args.backwards = true
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.motion.search"
key = "f"
name = "find char"
description = "Find the next char (include char in selection)"
args.acceptAfter = 1
computedArgs.skip = "count-1"
args.offset = "inclusive"
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.motion.search"
key = "shift+f"
name = "find char back"
description = "Find the previous char (include char in selection)"
args.acceptAfter = 1
args.offset = "inclusive"
args.backwards = true
computedArgs.skip = "count-1"
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.motion.search"
key = "t"
name = "to char"
description = "Find the next char (exclude char in selection)"
args.acceptAfter = 1
args.offset = "start"
computedArgs.skip = "count-1"
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.motion.search"
key = "shift+t"
name = "to char back"
description = "Find the previous char (exclude char in selection)"
args.acceptAfter = 1
args.offset = "end"
args.backwards = true
computedArgs.skip = "count-1"
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.motion.search"
key = "s"
name = "find char pair"
description = "To next character pair"
args.acceptAfter = 2
args.offset = "start"
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.motion.search"
key = "shift+s"
name = "char pair back"
description = "To previous character pair"
args.acceptAfter = 2
args.offset = "start"
args.backwards = true
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.motion.search"
key = ";"
name = "→ match"
description = "Repeat search motion forwards"
command = "master-key.nextMatch"
computedArgs.repeat = "count"
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.motion.search"
key = "shift+;"
name = "← match"
description = "Repeat search motion backwards"
command = "master-key.previousMatch"
computedArgs.repeat = "count"
mode = ["normal", "selectedit"]

[[path]]
id = "edit.motion.syntax"
name = "Motions around syntactic objects (e.g. parentheses and quotes)"
description = """
selection commands that move by a predefined syntactic object like brackets and quotes
"""

[[bind]]
path = "edit.motion.syntax"
key = "shift+["
name = "arnd parens"
description = "parens/brackets/braces and their contents"
command = "selection-utilities.expandAroundBrackets"

[[bind]]
path = "edit.motion.syntax"
key = "["
name = "in parens"
description = "text inside parens/brackets/braces"
command = "selection-utilities.expandWithinBrackets"

[[bind]]
path = "edit.motion.syntax"
key = "shift+5"
name = "to bracket"
description = "Move to matching bracket"
command = "editor.action.jumpToBracket"

[[bind]]
path = "edit.motion.syntax"
key = "' '"
name = "in quotes"
description = "text within current quotes"
command = "bracketeer.selectQuotesContent"

[[bind]]
path = "edit.motion.syntax"
key = "' shift+'"
name = "around quotes"
description = "text around current quotes"
command = "runCommands"
args = ["bracketeer.selectQuotesContent", "bracketeer.selectQuotesContent"]

[[bind]]
path = "edit.motion.syntax"
key = "' shift+."
name = "in <>"
description = "text inside angle brackets"
command = "extension.selectAngleBrackets"

[[bind]]
path = "edit.motion.syntax"
key = "' shift+,"
name = "in ><"
description = "text inside tag pairs (e.g. <a>text</a>)"
command = "extension.selectInTag"

[[bind]]
path = "edit.motion.syntax"
key = "]"
name = "inside indent"
description = "all text at the same indentation level"
command = "vscode-select-by-indent.select-inner"

[[bind]]
path = "edit.motion.syntax"
key = "shift+]"
name = "around indent"
description = "all text at the same indentation level along with the line above and below this (ala c-like syntax)"
command = "vscode-select-by-indent.select-outer"

[[bind]]
path = "edit.motion.syntax"
key = "' ]"
name = "indent+top"
description = "all text at the same indentation level and the line just about it (ala python syntax)"
command = "vscode-select-by-indent.select-outer-top-only"

[[path]]
id = "edit.motion.adjust"
name = "Seleciton Adjustments"
description = "Commands that adjust the boundaries of the current selections"

[[bind]]
path = "edit.motion.adjust"
key = "shift+r"
name = "expand no wht"
description = "select full line(s), and trim external whitespace"
command = "selection-utilities.trimSelectionWhitespace"

[[bind]]
path = "edit.motion.adjust"
name = 'narrow to subword'
description = "Narrow current selection so it starts and stops at a subword (e.g. 'snake' in snake_case)"
key = "shift+u"
command = "selection-utilities.narrowTo"
args.unit = "subident"
args.boundary = "both"

[[path]]
id = "edit.action"
name = "Actions"
description = "Commands that modify the document or UI"
default.kind = "action"
default.mode = "normal"

[[path]]
id = "edit.action.basic"
name = "Basic Actions"
description = "Essential actions required to edit text"

[[bind]]
path = "edit.action.basic"
# TODO: add documentation to these basic editor keys
key = "i"
name = "insert"
description = "Switch to insert mode (right before character)"
command = "runCommands"
args = ["selection-utilities.shrinkToActive", "master-key.enterInsert"]
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.action.basic"
key = "a"
mode = ["normal", "selectedit"]
command = "runCommands"
args = [
      "selection-utilities.shrinkToActive",
      "cursorRight",
      "master-key.enterInsert",
]

[[bind]]
path = "edit.action.basic"
key = "shift+i"
name = "insert start"
mode = ["normal", "selectedit"]
command = "runCommands"
args = [
      { command = "cursorMove", args = { to = "wrappedLineFirstNonWhitespaceCharacter", select = false } },
      "master-key.enterInsert",
]

[[bind]]
path = "edit.action.basic"
key = "shift+a"
name = "insert end"
mode = ["normal", "selectedit"]
command = "runCommands"
args = [
      { command = "cursorMove", args = { to = "wrappedLineEnd", select = false } },
      "master-key.enterInsert",
]

[[bind]]
path = "edit.action.basic"
key = "c"
name = "change"
description = """
Without a count: change selected region of text. With a count:
change up to `count` lines.
"""
when = "editorHasMultilineSelection"
mode = ["normal", "selectedit"]
command = "runCommands"
args = ["deleteRight", "editor.action.insertLineBefore", "master-key.enterInsert"]

[[bind]]
path = "edit.action.basic"
key = "c"
when = "!editorHasMultilineSelection && editorHasSelection"
command = "runCommands"
args = ["deleteRight", "master-key.enterInsert"]
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.action.basic"
key = "c"
when = "!editorHasSelection && master-key.count <= 1"
command = "runCommands"
args = [
      "expandLineSelection",
      "deleteRight",
      "editor.action.insertLineBefore",
      "master-key.enterInsert",
]
mode = ["normal", "selectedit"]

[[bind]]
path = "edit.action.basic"
key = "c"
mode = ["normal", "selectedit"]
when = "!editorHasSelection && master-key.count > 1"
command = "runCommands"
args = [
      { defined = "selectLinesDown" },
      "deleteRight",
      "editor.action.insertLineBefore",
      "master-key.enterInsert",
]

[[bind]]
path = "edit.action.basic"
key = "shift+c"
name = "change to/back"
description = """Without a count: change from current char to end of line. With a count:
change the previous `count` lines.
"""
mode = ["normal", "selectedit"]
when = "master-key.count <= 1"
command = "runCommands"
args = [
      "selection-utilities.shrinkToActive",
      "deleteAllRight",
      "master-key.enterInsert",
]

[[bind]]
path = "edit.action.basic"
key = "shift+c"
mode = ["normal", "selectedit"]
when = "master-key.count > 1"
command = "runCommands"
args = [
      { defined = "selectLinesUp" },
      "deleteRight",
      "editor.action.insertLineBefore",
      "master-key.enterInsert",
]

[[bind]]
path = "edit.action.basic"
key = "x"
mode = ["normal", "selectedit"]
name = "delete char"
command = "runCommands"
args = [
      "selection-utilities.shrinkToActive",
      { command = "cursorMove", args = { to = "right", select = true }, computedArgs = { value = "count" } },
     "editor.action.clipboardCutAction"
]

[[bind]]
path = "edit.action.basic"
key = "r"
name = "replace char"
mode = ["normal", "selectedit"]
description = "replace the character under the cursor"
command = "master-key.replaceChar"

[[bind]]
path = "edit.action.basic"
key = "ctrl+i"
name = "insert char"
mode = ["normal", "selectedit"]
description = "insert a character in front of the cursor"
command = "master-key.insertChar"

[[bind]]
path = "edit.action.basic"
name = 'join'
description = "Remove newline between current and next line"
key = "g y"
mode = ["normal", "selectedit"]
when = "!editorHasSelection"
command = "runCommands"
args = [ { defined = "selectLinesDown" }, 'editor.action.joinLines' ]

[[bind]]
path = "edit.action.basic"
name = 'join'
description = "Remove newline between current and next line"
mode = ["normal", "selectedit"]
key = "g y"
command = "editor.action.joinLines"

[[path]]
id = "edit.action.capitals"
name = "Capitlization Actions"
description = "Actions that change how words are capitalized"
default.mode = ["normal", "selectedit"]

[[bind]]
path = "edit.action.capitals"
name = 'camel'
description = "Swap style to lower camel case (`camelCase`)"
key = "` c"
command = "extension.changeCase.camel"

[[bind]]
path = "edit.action.capitals"
name = 'constant'
description = "Swap style to constant (`IS_CONSTANT`)"
key = "` shift+u"
command = "extension.changeCase.constant"

[[bind]]
path = "edit.action.capitals"
name = 'dot'
description = "Swap style to dot case (`dot.case`)"
key = "` ."
command = "extension.changeCase.dot"

[[bind]]
path = "edit.action.capitals"
name = 'kebab'
description = "Swap style to kebab case (`kebab-case`)"
key = "` -"
command = "extension.changeCase.kebab"

[[bind]]
path = "edit.action.capitals"
name = 'all lower'
description = "Swap all to lower case"
key = "` shift+l"
command = "extension.changeCase.lower"

[[bind]]
path = "edit.action.capitals"
name = 'first lower'
description = "Swap first letter to lower case"
key = "` l"
command = "extension.changeCase.lowerFirst"

[[bind]]
path = "edit.action.capitals"
name = 'spaces'
description = "Swap to spaces (`camelCase` -> `camel case`)"
key = "` space"
command = "extension.changeCase.no"

[[bind]]
path = "edit.action.capitals"
name = 'Camel'
description = "Swap to upper camel case (`CamelCase`)"
key = "` shift+c"
command = "extension.changeCase.pascal"

[[bind]]
path = "edit.action.capitals"
name = 'path'
description = "Swap to 'path' case (`path/case`)"
key = "` /"
command = "extension.changeCase.path"

[[bind]]
path = "edit.action.capitals"
name = 'snake'
description = "Swap to snake case (`snake_case`)"
key = "` shift+-"
command = "extension.changeCase.snake"

[[bind]]
path = "edit.action.capitals"
name = 'swap'
description = "Swap upper and lower case letters"
key = "` s"
command = "extension.changeCase.swap"

[[bind]]
path = "edit.action.capitals"
name = 'title'
description = "Swap to title case (all words have first upper case letter)"
key = "` t"
command = "extension.changeCase.title"

[[bind]]
path = "edit.action.capitals"
name = 'all upper'
description = "Swap to use all upper case letters"
key = "` shift+y"
command = "extension.changeCase.upper"

[[bind]]
path = "edit.action.capitals"
name = 'first upper'
description = "Swap first character to upper case"
key = "` u"
command = "extension.changeCase.upperFirst"

[[bind]]
path = "edit.action.capitals"
name = 'toggle'
description = "Toggle through all possible cases"
key = "` `"
command = "extension.toggleCase"

[[path]]
id = "edit.action.numbers"
name = "Number Editing"
description = "Commands that modify one or more numbers"

[[bind]]
path = "edit.action.numbers"
name = 'inc #'
description = "Increment a number by 1 (increases increment for subsequent selections)"
key = "="
when = "editorHasMultipleSelections"
command = "editor.emmet.action.incrementNumberByOne"

[[bind]]
path = "edit.action.numbers"
key = "="
command = "extension.incrementSelection"

[[bind]]
path = "edit.action.numbers"
name = 'dec #'
description = "Decrement a number by 1 (increases increment for subsequent selections)"
key = "shift+="
when = "editorHasMultipleSelections"
command = "editor.emmet.action.decrementNumberByOne"

[[bind]]
path = "edit.action.numbers"
key = "shift+="
command = "extension.decrementSelection"

[[bind]]
path = "edit.action.numbers"
name = 'inc all #'
description = "Increment all numbers by 1"
key = "g ="
command = "editor.emmet.action.incrementNumberByOne"

[[bind]]
path = "edit.action.numbers"
name = 'dec all #'
description = "Decrement all numbers by 1"
key = "g shift+="
command = "editor.emmet.action.decrementNumberByOne"

[[bind]]
path = "edit.action.basic"
name = 'toggle check'
description = "Toggle a markdown checkbox"
key = "shift+6"
command = "markdown-checkbox.markCheckbox"

[[bind]]
path = "edit.action.basic"
name = 'trim white'
description = "Delete all external whitespace (left and right edges)"
key = "g a"
command = "selection-utilities.trimWhitespace"

[[path]]
id = "edit.action.brackets"
name = 'Bracket/Quote Editing'
description = "Commands that edit two matching brackets or quotes."

[[bind]]
path = "edit.action.brackets"
name = 'remove pair'
description = "Delete a pairing (e.g. `()`)"
key = "g x"
command = "master-key.prefix"

[[bind]]
path = "edit.action.brackets"
name = 'parens/brackets'
description = "Removes pairs that start with `[`, `(` or `{`"
key = "g x ["
command = "bracketeer.removeBrackets"

[[bind]]
path = "edit.action.brackets"
name = 'swap pair'
description = "Change between different kinds of pairs (e.g. `(` to `{`)"
key = "g s"
command = "master-key.prefix"

[[bind]]
path = "edit.action.brackets"
name = 'parens/brackets'
description = "Swap between `[`, `(` and `{`"
key = "g s ["
command = "bracketeer.swapBrackets"

[[bind]]
path = "edit.action.brackets"
name = 'quotes'
description = "Change between different quotes"
key = "g s '"
command = "bracketeer.swapQuotes"

[[bind]]
path = "edit.action.brackets"
name = 'quotes'
description = "Removes quotes (', \" or `)"
key = "g x '"
command = "bracketeer.removeQuotes"

[[bind]]
path = "edit.action.brackets"
name = 'insert pair'
description = "Insert a pairing (e.g. ()) around a selection"
key = "g i"
command = "master-key.prefix"

[[bind]]
path = "edit.action.brackets"
name = 'paren'
description = "Insert parenthesis around selection"
key = "g i shift+9"
command = "runCommands"
args = ["master-key.enterInsert", { command = "type", args = { text = "(" } },
        "master-key.enterNormal" ]

[[bind]]
path = "edit.action.brackets"
name = 'paren'
description = "Insert parenthesis around selection"
key = "g i shift+,"
command = "runCommands"
args = [ "master-key.enterInsert", { command = "type", args = { text = "<" } },
       "master-key.enterNormal" ]

[[bind]]
path = "edit.action.brackets"
name = 'ticks'
description = "Insert ticks (``) around selection"
key = "g i `"
command = "runCommands"
args = [ "master-key.enterInsert", { command = "type", args = { text = "`" } },
       "master-key.enterNormal" ]

[[bind]]
path = "edit.action.brackets"
name = 'dbl quotes'
description = "Insert quotes (\"\") around selection"
key = "g i shift+'"
command = "runCommands"
args = [ "master-key.enterInsert", { command = "type", args = { "text" = "\"" } },
       "master-key.enterNormal" ]

[[bind]]
path = "edit.action.brackets"
name = 'sgl quotes'
description = "Insert single quotes ('') around selection"
key = "g i '"
command = "runCommands"
args = [ "master-key.enterInsert", { command = "type", args = { text = "'" } },
       "master-key.enterNormal" ]

[[bind]]
path = "edit.action.brackets"
name = 'start'
description = "Insert stars (**) around selection"
key = "g i shift+8"
command = "runCommands"
args = [ "master-key.enterInsert", { command = "type", args = { text = "*" } },
       "master-key.enterNormal" ]

[[bind]]
path = "edit.action.brackets"
name = 'curly'
description = "Insert curly brackets ({}) around selection"
key = "g i shift+["
command = "runCommands"
args = [ "master-key.enterInsert", { command = "type", args = { text = "{" } },
       "master-key.enterNormal" ]

[[bind]]
path = "edit.action.brackets"
name = 'square'
description = "Insert square brackets ([]) around selection"
key = "g i ["
command = "runCommands"
args = [ "master-key.enterInsert", { command = "type", args = { text = "[" } },
       "master-key.enterNormal" ]

[[path]]
id = "edit.action.clipboard"
name = "Clipboard Operations"
description = "Operations that manipulate the clipboard in some way."
default.mode = ["normal", "selectedit"]

[[bind]]
path = "edit.action.clipboard"
key = "d"
name = "delete"
description = """
Without a count: delete selected text (and store to clipboard). With a
count, delete up to the next `count` lines and store to clipboard.
"""
when = "!editorHasSelection"
command = "runCommands"
args = [
      { defined = "selectLinesDown" },
      "editor.action.clipboardCutAction",
      { command = "master-key.setMode", args = { value = "normal" } },
]

[[bind]]
path = "edit.action.clipboard"
key = "d"
when = "editorHasSelection"
command = "runCommands"
args = [
      "editor.action.clipboardCutAction",
      { command = "master-key.setMode", args = { value = "normal" } },
]

[[bind]]
path = "edit.action.clipboard"
key = "shift+d"
name = "without count: Delete from cursor to end of line; with count: Delete from current line up `count` number of keys."
command = "runCommands"
args = [
      "selection-utilities.shrinkToActive",
      { command = "cursorMove", args = { to = "wrappedLineEnd", select = true} },
      "editor.action.clipboardCutAction"
]

[[bind]]
path = "edit.action.clipboard"
key = "shift+d"
when = "master-key.count > 1"
command = "runCommands"
args = [{ defined = "selectLinesUp" }, "deleteRight"]

[[bind]]
path = "edit.action.clipboard"
key = "y"
name = "copy"
description = "copy selected text to clipboard"
command = "runCommands"
args = ["editor.action.clipboardCopyAction", "selection-utilities.shrinkToActive"]

[[bind]]
path = "edit.action.clipboard"
key = "shift+y"
name = "copy (eol/up)"
description = "without a count: copy to end of line; with a count: copy this and the previous N lines"
when = "master-key.count <= 1"
command = "runCommands"
args = [
      "selection-utilities.shrinkToActive",
      { command = "cursorMove", args = { to = "wrappedLineEnd", select = true} },
      "editor.action.clipboardCopyAction",
      "editor.action.shrinkToActive"
]

[[bind]]
path = "edit.action.clipboard"
key = "shift+y"
when = "master-key.count > 1"
command = "runCommands"
args = [
      { defined = "selectLinesUp" },
      "editor.action.clipboardCopyAction",
      "editor.action.shrinkToActive"
]

[[bind]]
path = "edit.action.clipboard"
key = "v"
name = "paste after"
description = "Paste the next after the cursor/selection"
when = "editorHasSelection"
command = "runCommands"
args = ["selection-utilities.activeAtEnd", "selection-utilities.shrinkToActive", "editor.action.clipboardPasteAction"]

[[bind]]
path = "edit.action.clipboard"
key = "v"
when = "!editorHasSelection"
command = "runCommands"
args = ["cursorRight", "editor.action.clipboardPasteAction"]

[[bind]]
path = "edit.action.clipboard"
key = "shift+v"
name = "paste before"
description = "Paste before the cursor/selection"
when = "editorHasSelection"
command = "runCommands"
args = ["selection-utilities.activeAtStart", "selection-utilities.shrinkToActive", "editor.action.clipboardPasteAction"]

[[bind]]
path = "edit.action.clipboard"
key = "shift+v"
when = "!editorHasSelection"
command = "runCommands"
args = ["cursorRight", "editor.action.clipboardPasteAction"]

[[bind]]
path = "edit.action.clipboard"
name = "paste after line"
description = "Paste text after current line"
key = "/ v"
command = "runCommands"
args = [
      "expandLineSelection",
      "selection-utilities.activeAtEnd",
      "selection-utilities.shrinkToActive",
      "cursorDown",
      "editor.action.clipboardPasteAction",
]

[[bind]]
path = "edit.action.clipboard"
name = "paste before line"
description = "Paste text before current line"
key = "/ shift+v"
command = "runCommands"
args = [
      "expandLineSelection",
      "selection-utilities.activeAtStart",
      "selection-utilities.shrinkToActive",
      "editor.action.clipboardPasteAction",
]

[[path]]
id = "edit.action.open_lines"
name = "Line opening actions"
description = """
These commands provides several ways of adding lines above or below the current line
"""
default.mode = ["normal", "selectedit"]

[[bind]]
path = "edit.action.open_lines"
name = "open, act →"
description = "without selection: open a line below current line and enter insert, with seleciton: move cursort to start"
key = "o"
mode = ["normal", "selectedit"]
when = "!editorHasSelection"
command = "runCommands"
args = ["editor.action.insertLineAfter", "master-key.enterInsert"]

[[bind]]
path = "edit.action.open_lines"
key = "o"
mode = ["normal", "selectedit"]
when = "editorHasSelection"
command = "selection-utilities.activeAtEnd"

[[bind]]
path = "edit.action.open_lines"
name = "add line below"
description = "open a line below current line"
key = "g o"
command = "editor.action.insertLineAfter"

[[bind]]
path = "edit.action.open_lines"
name = "open blw, act ←"
description = "without selection: open a line above current line and enter insert, with selection: move cursor to end"
key = "shift+o"
when = "!editorHasSelection"
mode = ["normal", "selectedit"]
command = "runCommands"
args = [ "editor.action.insertLineBefore", "master-key.enterInsert" ]

[[bind]]
path = "edit.action.open_lines"
name = "open blw, act ←"
description = "without selection: open a line above current line and enter insert, with selection: move cursor to end"
key = "shift+o"
mode = ["normal", "selectedit"]
when = "editorHasSelection"
command = "selection-utilities.activeAtStart"

[[bind]]
path = "edit.action.open_lines"
name = "open above"
description = "open a line above current line"
key = "g shift+o"
command = "editor.action.insertLineBefore"

[[path]]
id = "edit.action.indent"
name = "Indentation"
description = """
Operations that affect line indentation
"""
default.mode = ["normal", "selectedit"]

[[bind]]
path = "edit.action.indent"
key = "shift+."
name = "indent"
description = "Indent lines"
when = "master-key.count >= 1"
command = "runCommands"
args = [
      { defined = "selectLinesDown" },
      "editor.action.indentLines",
      "selection-utilities.shrinkToActive"
]

[[bind]]
path = "edit.action.indent"
key = "shift+."
name = "indent"
description = "Indent lines"
command = "editor.action.indentLines"

[[bind]]
path = "edit.action.indent"
key = "shift+,"
name = "deindent"
when = "master-key.count >= 1"
description = "Deindent lines"
command = "runCommands"
args = [
      { defined = "selectLinesDown" },
      "editor.action.outdentLines",
      "selection-utilities.shrinkToActive"
]

[[bind]]
path = "edit.action.indent"
key = "shift+,"
name = "deindent"
when = "master-key.count < 1"
description = "De-indent lines"
command = "editor.action.outdentLines"

[[bind]]
path = "edit.action.indent"
key = "g /"
name = "format"
description = "Format code"
when = "master-key.count >= 1"
command = "runCommands"
args = [
      { defined = "selectLinesDown" },
      "editor.action.formatSelection",
      "selection-utilities.shrinkToActive"
]

[[bind]]
path = "edit.action.indent"
key = "g /"
when = "master-key.count < 1"
command = "editor.action.formatSelection"

[[path]]
id = "edit.action.history"
name = "History Commands"
description = "Commands that interact with edit or cursor history."
default.mode = ["normal", "selectedit"]

[[bind]]
path = "edit.action.history"
name = "undo"
description = "VSCode Undo"
key = "z"
command = "runCommands"
args = [ "undo", "selection-utilities.shrinkToActive" ]

[[bind]]
path = "edit.action.history"
name = "undo"
description = "VSCode Redo"
key = "shift+z"
command = "runCommands"
args = [ "redo", "selection-utilities.shrinkToActive" ]

[[bind]]
path = "edit.action.history"
name = "cursor undo"
description = "VSCode Cursor Undo"
key = "-"
command = "cursorUndo"

[[bind]]
path = "edit.action.history"
name = "cursor redo"
description = "VSCode Cursor Redo"
key = "shift+-"
command = "cursorRedo"

[[bind]]
path = "edit.action.history"
name = "nav ←"
description = "Go back in navigation history (e.g. goto definition)"
key = "g -"
command = "workbench.action.navigateBackInNavigationLocations"

[[bind]]
path = "edit.action.history"
name = "nav →"
description = "Go forward in navigation history (e.g. goto definition)"
key = "g shift+-"
command = "workbench.action.navigateForwardInNavigationLocations"

[[bind]]
path = "edit.action.history"
name = "edit hist ←"
description = "Go back in edit history (e.g. goto definition)"
key = "' -"
command = "workbench.action.navigateBackInEditLocations"

[[bind]]
path = "edit.action.history"
name = "edit hist →"
description = "Go forward in edit history (e.g. goto definition)"
key = "' shift+-"
command = "workbench.action.navigateForwardInEditLocations"

[[bind]]
path = "edit.action.history"
name = "record"
description = "Start/stop recording Master Key commands"
key = "shift+q"
when = "!master-key.record"
command = "master-key.set"
args.name = "record"
args.value = true

[[bind]]
path = "edit.action.history"
name = "record"
description = """
Start/stop recording key presses defined by Master Key pushing it to the
top of the `history` stack once recording finishes."
"""
key = "shift+q"
when = "master-key.record"
command = "runCommands"

[[bind.args]]
command = "master-key.set"
args.name = "record"
args.value = false

[[bind.args]]
command = "master-key.pushHistoryToStack"
args.range.from = """
commandHistory[i].name === "record" && i !== commandHistory.length-1
"""
args.range.to = "i-1"

[[bind]]
path = "edit.action.history"
name = "replay"
description = """
Replay the Master Key command sequence at the top of the `history` stack. Specifying
a count requests the Nth most recent item on this stack.
"""
key = "q q"
command = "master-key.replayFromStack"
computedArgs.index = "count"

[[bind]]
path = "edit.action.history"
name = "store macro"
description = """
Stores the top of the `history` stack into a named register. Specifying a count stores the
Nth most recent item on this stack.
"""
key = "q s"
command = "master-key.storeNamed"
args.description = "Save Macro"
args.name = "macro"
args.contents = "macro[macro.length-count-1]"

[[bind]]
path = "edit.action.history"
name = "replay stored"
description = """
Replay a recorded Master Key command sequence from a named register, pushing
it to the front of the history stack.
"""
key = "q r"
command = "master-key.restoreNamed"
args.description = "Macro"
args.name = "macro"
args.doAfter = [
      { command = "master-key.pushHistoryToStack", computedArgs = { value = "captured" } },
      { command = "master-key.replayFromStack", args = { index = 0 } }
]

[[bind]]
path = "edit.action.history"
name = "store last"
description = """
Store the N most recently run commands as a macro, where N is the count (defaulting to 1).
"""
key = "q l"
command = "master-key.pushHistoryToStack"
args.range.from = "i-(count || 1)"
args.range.to = "i-1"

[[bind]]
path = "edit.action.history"
name = "repeat action"
description = """
Repeat the last action command. Actions usually modify the text of a document in one way or
antoher. (But, e.g. sending text to the REPL is also considered an editor action).
"""
key = "."
command = "runCommands"

[[bind.args]]
command = "master-key.replayFromHistory"
# we can repeat any action but history-related actions; we make an exception
# for replaying macros, which can be repeated
args.at = """
commandHistory[i].path.startsWith('edit.action') &&
(!commandHistory[i].path.startsWith('edit.action.history') ||
 commandHistory[i].name == 'replay')
"""

[[bind.args]]
command = "master-key.enterNormal"

[[bind]]
path = "edit.action.history"
name = "repeat last subject"
description = """
Repeat the last subject: the selection command that occurred right before an action. For
instance `w` followed by `d` selects a word and deletes it. The `w` command would be the
last noun until some action is run after `d`.
"""
key = ","
command = "master-key.replayFromHistory"
args.at = """
commandHistory[i].path.startsWith("edit.motion") &&
commandHistory[i+1].path.startsWith("edit.action") &&
!(commandHistory[i+1].name.startsWith("repeat ") &&
  commandHistory[i+1].path.startsWith("edit.action.history"))
"""

[[path]]
id = "edit.action.comment"
name = "Comments"
description = """
Operations that modify comments
"""
default.mode = ["normal", "selectedit"]

[[bind]]
path = "edit.action.comment"
key = "g ;"
name = "comment lines"
description = "select next comment"
when = "master-key.count >= 1"
command = "runCommands"
args = [
      { defined = "selectLinesDown" },
      "editor.action.commentLine",
]

[[bind]]
path = "edit.action.comment"
key = "g ;"
when = "master-key.count < 1"
command = "editor.action.commentLine"

[[bind]]
path = "edit.action.comment"
key = "g shift+;"
name = "block comment lines"
description = "select previous comment"
when = "master-key.count >= 1"
command = "runCommands"
args = [
      { defined = "selectLinesDown" },
      "editor.action.blockComment",
      "selection-utilities.shrinkToActive",
]

[[bind]]
path = "edit.action.comment"
key = "g shift+;"
when = "master-key.count < 1"
command = "editor.action.blockComment"

[[bind]]
path = "edit.action.comment"
key = "g q"
name = "wrap"
description = "wrap text, preserving commenting"
command = "rewrap.rewrapComment"

[[path]]
id = "edit.action.terminal"
name = "Terminal Actions"
description = "Commands that send text from the editor to the terminal"
default.kind = "action"
default.mode = ["normal", "selectedit"]

[[bind]]
path = "edit.action.terminal"
name = "to repl"
description = """
send text to a terminal (usually containing a REPL); use language
specific extensions when available and put the pasted code into a block (when defined)."
"""
key = "m"
when = "editorLangId == 'julia' && !editorHasSelection"
command = "runCommands"
args = [
      { defined = "selectLinesDown" },
      "expandLineSelection", "selection-utilities.trimSelectionWhitespace",
      "language-julia.executeCodeBlockOrSelectionAndMove"
]

[[bind]]
path = "edit.action.terminal"
key = "m"
when = "editorLangId == 'julia' && editorHasSelection"
command = "language-julia.executeCodeBlockOrSelectionAndMove"

[[bind]]
path = "edit.action.terminal"
key = "m"
when = "editoLangId != 'julia' && !(master-key.firstSelectionOrWord =~ /\\n/)"
command = "runCommands"
args = ["terminal-polyglot.send-text",
      "selection-utilities.shrinkToActive"]

[[bind]]
path = "edit.action.terminal"
key = "m"
when = "editoLangId != 'julia' && master-key.firstSelectionOrWord =~ /\\n/"
command = "runCommands"
args = ["terminal-polyglot.send-block-text",
      "selection-utilities.shrinkToActive"]

[[bind]]
path = "edit.action.terminal"
key = "shift+m"
name = "to repl (v2)"
description = """
send text to a terminal (usually containing a REPL), placing in a block when defined.
"""
when = "master-key.firstSelectionOrWord =~ /\\n/"
command = "runCommands"
args = ["terminal-polyglot.send-block-text", "selection-utilities.shrinkToActive"]

[[bind]]
path = "edit.action.terminal"
key = "shift+m"
name = "to repl (v2)"
description = """
send text to a terminal (usually containing a REPL), placing in a block when defined.
"""
when = "!(master-key.firstSelectionOrWord =~ /\\n/)"
command = "runCommands"
args = ["terminal-polyglot.send-text", "selection-utilities.shrinkToActive"]

[[bind]]
path = "edit.action.terminal"
key = "g m"
name = "to repl (v3)"
description = """
send text to a terminal (usually containing a REPL)
"""
command = "runCommands"
args = ["terminal-polyglot.send-text", "selection-utilities.shrinkToActive"]

## TODO: add git/version control commands

[[path]]
id = "edit.navigation"
name = "Document Navigation"
default.kind = "select"
description = """
Commands that navigate to various places in a document
"""

[[bind]]
path = "edit.navigation"
name = "error →"
description = """
move to next error
"""
key = "/ e"
command = "editor.action.marker.next"

[[bind]]
path = "edit.navigation"
name = "error ←"
description = """
move to previous error
"""
key = "/ shift+e"
command = "editor.action.marker.prev"

[[bind]]
path = "edit.navigation"
name = "diff →"
description = """
move to and show next change
"""
key = "/ d"
command = "editor.action.dirtydiff.next"

[[bind]]
path = "edit.navigation"
name = "diff ←"
description = """
move to and show previous change
"""
key = "/ shift+d"
command = "editor.action.dirtydiff.previous"

[[bind]]
path = "edit.navigation"
name = "change →"
description = """
move to next change
"""
key = "' d"
command = "workbench.action.editor.nextChange"

[[bind]]
path = "edit.navigation"
name = "change ←"
description = """
move to previous change
"""
key = "' shift+d"
command = "workbench.action.editor.previousChange"

[[path]]
id = "window"
name = "Window Manipulation"
description = "Commands for navigating and manipulating the window/editor panes in some way"
default.kind = "window"
default.mode = "normal"
default.when = "!inputFocus || editorTextFocus"

[[bind]]
path = "window"
name = "open file"
description = "Open file using quick open"
key = "/ f"
command = "workbench.action.quickOpen"

[[bind]]
path = "window"
name = "open recent"
description = "Open recent file"
key = "/ r"
command = "workbench.action.openRecent"

[[bind]]
path = "window"
name = "command"
description = "Show the VSCode command palette"
key = "/ ,"
command = "workbench.action.showCommands"

[[bind]]
path = "window"
name = "goto line"
description = "Use VSCode goto line command"
key = "/ g"
command = "workbench.action.gotoLine"
when = "editorTextFocus"

[[bind]]
path = "window"
name = "center"
description = "center window at primary cursor position"
key = "/ ."
command = "selection-utilities.revealActive"
args.at = "center"
when = "editorTextFocus"

[[bind]]
path = "window"
name = "top"
description = "center window so that primary cursor is at the top"
key = "/ shift+k"
command = "selection-utilities.revealActive"
args.at = "top"
when = "editorTextFocus"

[[bind]]
path = "window"
name = "bottom"
description = "center window so that primary cursor is at the bottom"
key = "/ shift+j"
command = "selection-utilities.revealActive"
args.at = "bottom"
when = "editorTextFocus"

[[bind]]
path = "window"
name = "max"
description = "minimize size of all other windows"
key = "/ shift+m"
command = "workbench.action.minimizeOtherEditors"

[[bind]]
path = "window"
name = "equal"
description = "equalzize size of all windows"
key = "/ ="
command = "workbench.action.evenEditorWidths"

[[bind]]
path = "window"
name = "split"
description = "toggle split editor view"
key = "/ shift+\\"
command = "workbench.action.toggleSplitEditorInGroup"

[[bind]]
path = "window"
name = "split →"
description = "move to other side of editor split"
key = "/ shift+l"
command = "workbench.action.focusOtherSideEditor"

[[bind]]
path = "window"
name = "→"
description = "move focus to window to the right"
key = "/ l"
command = "workbench.action.focusRightGroup"

[[bind]]
path = "window"
name = "←"
description = "move focus to window to the left"
key = "/ h"
command = "workbench.action.focusLeftGroup"

[[bind]]
path = "window"
name = "↑"
description = "move focus to window above"
key = "/ k"
command = "workbench.action.focusAboveGroup"

[[bind]]
path = "window"
name = "↓"
description = "move focus to window below"
key = "/ j"
command = "workbench.action.focusBelowGroup"

[[bind]]
path = "window"
name = "hover"
description = "show the hover view"
key = "g h"
command = "editor.action.showHover"
when = "editorTextFocus"

[[bind]]
path = "window"
name = "open"
description = "open the file name under the cursor"
key = "g f"
command = "extension.openFileFromPath"
when = "editorTextFocus"

[[bind]]
path = "window"
name = "to refs"
description = "jump to a location where this symbol is referenced"
key = "g r"
command = "editor.action.goToReferences"
when = "editorTextFocus"

[[bind]]
path = "window"
name = "go to"
description = "go to the definition of symbol under curosr"
key = "g d"
command = "editor.action.revealDefinition"
when = "editorTextFocus"

[[bind]]
path = "window"
name = "go to (aside)"
description = "go to the definition of symbol under curosr in an editor to the side"
key = "g shift+d"
command = "editor.action.revealDefinitionAside"
when = "editorTextFocus"

[[path]]
id = "window.bookmark"
name = "Bookmarks"
description = "Commands for creating and interacting with book marks"
default.when = "editorTextFocus"

[[bind]]
path = "window.bookmark"
name = "mark"
description = "toggle bookmark at given line (use 'j, 'k and '# to navigate bookmarks)"
key = "g space"
command = "vsc-labeled-bookmarks.toggleBookmark"

[[bind]]
path = "window.bookmark"
name = "mark ↓"
description = "move to next bookmark"
key = "' j"
when = "!master-key.select_on && !editorHasSelection"
command = "vsc-labeled-bookmarks.navigateToNextBookmark"

[[bind]]
path = "window.bookmark"
key = "' j"
when = "master-key.select_on || editorHasSelection"
command = "vsc-labeled-bookmarks.expandSelectionToNextBookmark"

[[bind]]
path = "window.bookmark"
name = "mark ↑"
description = "move to previous bookmark"
key = "' k"
when = "!master-key.select_on && !editorHasSelection"
command = "vsc-labeled-bookmarks.navigateToPreviousBookmark"

[[bind]]
path = "window.bookmark"
name = "mark ↑"
description = "move to previous bookmark"
key = "' k"
when = "master-key.select_on || editorHasSelection"
command = "runCommands"
args = ["vsc-labeled-bookmarks.expandSelectionToPreviousBookmark",
      "selection-utilities.activeAtStart"]

[[bind]]
path = "window.bookmark"
name = "mark"
description = "remove bookmark (use quick selection)"
key = "g x space"
command = "vsc-labeled-bookmarks.deleteBookmark"

[[bind]]
path = "window.bookmark"
name = "nav marks"
description = "reveal quick selection to move to a bookmark"
key = "' shift+3"
command = "vsc-labeled-bookmarks.navigateToBookmark"

[[path]]
id = "window.create"
name = "Create New Panes"
description = "Commands for placing editors in new panes."

[[bind]]
path = "window.create"
name = "create"
description = "create new window of editor in given direction"
key = "/ c"
kind = "prefix"
resetTransient = false
command = "master-key.prefix"

[[bind]]
path = "window.create"
name = "→"
description = "create new window of editor to left"
key = "/ c l"
command = "workbench.action.splitEditorRight"

[[bind]]
path = "window.create"
name = "←"
description = "create new window of editor to left"
key = "/ c h"
command = "workbench.action.splitEditorLeft"

[[bind]]
path = "window.create"
name = "↓"
description = "create new window of editor below"
key = "/ c j"
command = "workbench.action.splitEditorDown"

[[bind]]
path = "window.create"
name = "↑"
description = "create new window of editor above"
key = "/ c k"
command = "workbench.action.splitEditorUp"

[[path]]
id = "window.move"
name = "Move Editors"
description = "Move editors between panes"

[[bind]]
path = "window.move"
name = "move to"
description = "move editor to window in given direction"
key = "/ m"
resetTransient = false
command = "master-key.prefix"

[[bind]]
path = "window.move"
name = "→"
description = "move editor to window to left"
key = "/ m l"
command = "workbench.action.moveEditorToRightGroup"

[[bind]]
path = "window.move"
name = "←"
description = "move editor to window to left"
key = "/ m h"
command = "workbench.action.moveEditorToLeftGroup"

[[bind]]
path = "window.move"
name = "↓"
description = "move editor to window below"
key = "/ m j"
command = "workbench.action.moveEditorToBelowGroup"

[[bind]]
path = "window.move"
name = "↑"
description = "move editor to window above"
key = "/ m k"
command = "workbench.action.moveEditorToAboveGroup"

[[bind]]
path = "window.move"
name = "close pane"
description = "close the given group of editors"
key = "/ x"
command = "workbench.action.closeEditorsInGroup"

[[path]]
id = "edit.select_edit"
name = "Selection Editing"
description = "Various kakaune inspired commands for editing multiple selections"
default.mode = "selectedit"
default.kind = "select"

[[bind]]
path = "edit.select_edit"
name = "select-edit"
description = """
Enter a mode where you can edit and manipulate (possibly multiple) selections with ease.
Entering the mode also adds a new cursor for the next match to the word under the curosr
(or selection). You can use the count to ask multiple matches to be added.
(You can use `,\"` to avoid adding any cursors).
"""
key = "shift+'"
when = "editorHasMultipleSelections"
command = "master-key.setMode"
args.value = "selectedit"
mode = "normal"

[[bind]]
path = "edit.select_edit"
key = "shift+'"
when = "!editorHasMultipleSelections"
command = "runCommands"
args = [
      {command = "master-key.setMode", args = { value = "selectedit"} },
      {command = "master-key.repeat", args = { command = "selection-utilities.addNext" }, computedArgs = { repeat = 'count'} }
]
mode = "normal"

[[bind]]
path = "edit.select_edit"
name = "select-edit"
description = """
Enter a mode where you can edit and manipulate (possibly multiple) selections with ease.
No additional cursors will be added when entering the mode with this command.
"""
key = "/ shift+'"
command = "master-key.setMode"
args.value = "selectedit"
mode = "normal"

[[bind]]
path = "edit.select_edit"
name = 'normal'
description = "return to a single selection and return to normal mode"
key = "enter"
command = "runCommands"
args = ["selection-utilities.cancelSelection", "master-key.enterNormal"]

[[bind]]
path = "edit.select_edit"
name = "add →"
description = "add cursor at the next match to the primary cursor's text"
key = ["shift+'", "shift+j"]

command = "master-key.repeat"
args.command = "selection-utilities.addNext"
computedArgs.repeat = 'count'

[[bind]]
path = "edit.select_edit"
name = "add ←"
description = "add cursor at the previous match to the primary cursor's text"
key = "shift+k"

command = "master-key.repeat"
args.command = "selection-utilities.addPrev"
computedArgs.repeat = 'count'

[[bind]]
path = "edit.select_edit"
name = "skip →"
description = "move primary cursor to the next match of the primary cursor's text"
key = "g j"

command = "master-key.repeat"
args.command = "selection-utilities.skipNext"
computedArgs.repeat = 'count'

[[bind]]
path = "edit.select_edit"
name = "skip →"
description = "move primary cursor to the previous match of the primary cursor's text"
key = "g k"

command = "master-key.repeat"
args.command = "selection-utilities.skipPrev"
computedArgs.repeat = 'count'

[[bind]]
path = "edit.select_edit"
name = "align ←"
description = "align selections left"
key = "="
command = "selection-utilities.alignSelectionsLeft"

[[bind]]
path = "edit.select_edit"
name = "align →"
description = "align selections right"
key = "shift+="
command = "selection-utilities.alignSelectionsRight"

[[bind]]
path = "edit.select_edit"
name = "save sel"
description = """
save all selections to the default register.
Use a count to specify an alternate register
"""
key = "' c"
mode = "normal"
command = "runCommands"
args = [
      { command = "selection-utilities.appendToMemory", computedArgs = { register = "count || 'default'" } },
      "selection-utilities.shrinkToActive", "master-key.enterNormal"
]

[[bind]]
path = "edit.select_edit"
name = "load sel"
description = """
load previously saved selections in the default register.
Use a count to specify an alternate register
"""
key = "' v"
mode = ["normal", "selectedit"]
command = "runCommands"
args = [
      { command = "selection-utilities.restoreAndClear", computedArgs = { register = "count || 'default'" } },
]

[[bind]]
path = "edit.select_edit"
when = "editorHasMultipleSelections"
key = "' v"
mode = ["normal", "selectedit"]
command = "runCommands"
args = [
      { command = "selection-utilities.restoreAndClear", computedArgs = { register = "count || 'default'" } },
      { command = "setMode", args = { value = "selectedit" } }
]

[[bind]]
path = "edit.select_edit"
name = "exchange sel"
description = """
exchange selections: with no saved selection, saves the selection, with saved selections exchanges text of current selections with those of the saved selections (number of selections must match). Use a count to specify an alternate register.
"""
key = "' x"
mode = ["normal", "selectedit"]
command = "selection-utilities.swapWithMemory"
computedArgs.register = "count || 'default'"

[[bind]]
path = "edit.select_edit"
name = "rem saved sel"
description = """
remove the most recently saved selection from the list of saved selections
"""
key = "' n"
mode = ["normal", "selectedit"]

 command = "selection-utilities.deleteLastSaved"
computedArgs.register = "count || 'default'"

[[bind]]
path = "edit.select_edit"
key = "' enter"
name = "split sel"
description = """
split selection into multiple selections by new line charactesr
"""
mode = ["normal", "selectedit"]
command = "runCommands"
args = [
      { defined = "selectLinesDown" },
      "selection-utilities.splitByNewline",
      { command = "master-key.setMode", args = { value = "selectedit" } }
]

[[bind]]
path = "edit.select_edit"
name = "sel all"
description = """
create a selection for every match of the current word (or selection)
"""
key = "' shift+8"
mode = ["normal", "selectedit"]
command = "runCommands"
args = [
      "editor.action.selectHighlights",
      { command = "master-key.setMode", args = { value = "selectedit" } }
]

[[bind]]
path = "edit.select_edit"
name = "restore sel"
description = """
restore the most recently cleared selection
"""
key = "/ -"
mode = ["normal", "selectedit"]

 command = "selection-utilities.restoreAndClear"
args.register = "cancel"

[[bind]]
path = "edit.select_edit"
when = "editorHasMultipleSelections"
key = "/ -"
mode = ["normal", "selectedit"]
command = "runCommands"
args = [
      { command = "selection-utilities.restoreAndClear", args = { register = "cancel"} },
      { command = "master-key.setMode", args = { value = "selectedit" } }
]

[[bind]]
path = "edit.select_edit"
name = "insert sel ↑"
description = """
insert cursor on line above
"""
key = "' shift+k"
mode = ["normal", "selectedit"]
command = "runCommands"
args = [
      {command = "master-key.repeat", args = { command = "editor.action.insertCursorAbove" }, computedArgs = { repeat = 'count'} },
      { command = "master-key.setMode", args = { value = "selectedit" } }
]

[[bind]]
path = "edit.select_edit"
name = "insert sel ↓"
description = """
insert cursor on line below
"""
key = "' shift+j"
mode = ["normal", "selectedit"]
command = "runCommands"
args = [
      {command = "master-key.repeat", args = { command = "editor.action.insertCursorBelow" }, computedArgs = { repeat = 'count'} },
      { command = "master-key.setMode", args = { value = "selectedit" }}
]

[[bind]]
path = "edit.select_edit"
name = "reset"
description = "collapse all selections to the active position, and return to normal mode"
key = "r"
command = "runCommands"
args = [ "master-key.enterNormal", "selection-utilities.shrinkToActive" ]

[[bind]]
path = "edit.select_edit"
name = "→ sel"
description = "make the next selection primary; primary selections determine from where you add cursors, what cursor you delete, and where the cursor goes when you clear or save selections"
key = "j"

command = "master-key.repeat"
args.command = "selection-utilities.movePrimaryRight"
computedArgs.repeat = 'count'

[[bind]]
path = "edit.select_edit"
name = "← sel"
description = "make the previous selection primary; primary selections determine from where you add cursors, what cursor you delete, and where the cursor goes when you clear or save selections"
key = "k"

command = "master-key.repeat"
args.command = "selection-utilities.movePrimaryLeft"
computedArgs.repeat = 'count'

[[bind]]
path = "edit.select_edit"
name = "del. sel"
description = "remove the primary selection"
key = "d"

command = "master-key.repeat"
args.command = "selection-utilities.deletePrimary"
computedArgs.repeat = 'count'

[[bind]]
path = "edit.select_edit"
key = "s"
name = "split"
description = "split the selection by a specified marker"
resetTransient = false
command = "master-key.prefix"

[[path]]
id = "edit.select_edit.split"
name = "Split Selections"
description = "Commands that split a selection into multiple selections"

[[bind]]
path = "edit.select_edit.split"
name = "newline"
description = "split by newlines"
key = "s enter"
command = "selection-utilities.splitByNewline"

[[bind]]
path = "edit.select_edit.split"
name = "string"
description = "split by a given string"
key = "s s"
command = "selection-utilities.splitBy"

[[bind]]
path = "edit.select_edit.split"
name = "regex"
description = "split by a given regular expression"
key = "s r"
command = "selection-utilities.splitByRegex"


[[bind]]
path = "edit.select_edit.split"
name = "character"
description = "split by a given character"
key = "s c"
command = "master-key.captureChar"
args.acceptAfter = 1
args.doAfter = [{ command = "selection-utilities.splitBy", computedArgs = { text = "capture" } }]

[[path]]
id = "edit.select_edit.create"
name = "Create Selections"
description = "Create some number of selections derived from the bounds of the current selections"

[[bind]]
path = "edit.select_edit.create"
name = "create"
description = """
create a set of selections by the specified marker that all fall within the current
set of selections
"""
key = "/ /"
resetTransient = false
command = "master-key.prefix"

[[bind]]
path = "edit.select_edit.create"
name = "string"
description = "create selections of given string scoped to the current selections"
key = "/ s"
command = "selection-utilities.createBy"

[[bind]]
path = "edit.select_edit.create"
name = "regex"
description = "create selections of given regular expression scoped to the current selections"
key = "/ r"
command = "selection-utilities.createByRegex"

[[bind]]
path = "edit.select_edit.create"
name = "character"
description = "create selections of given character scoped to the current selections"
key = "/ c"
command = "master-key.captureChar"
args.acceptAfter = 1
args.executeAfter = { command = "selection-utilities.createBy", args = { text = "capture" } }

[[bind]]
path = "edit.select_edit.create"
name = "include by"
description = """
Include all selections that contain a given marker
"""
key = "["
resetTransient = false
command = "master-key.prefix"

[[bind]]
path = "edit.select_edit.create"
name = "exclude by"
description = """
Exclude all selections that contain a given marker
"""
key = "]"
resetTransient = false
command = "master-key.prefix"

[[bind]]
path = "edit.select_edit.split"
name = "string"
description = "Include all selections that contain a given string"
key = "[ s"
command = "selection-utilities.includeBy"

[[bind]]
path = "edit.select_edit.split"
name = "string"
description = "Exclude all selections that contain a given string"
key = "] s"
command = "selection-utilities.excludeBy"

[[bind]]
path = "edit.select_edit.split"
name = "regex"
description = "Include all selections that contain a given regular expression"
key = "[ r"
command = "selection-utilities.includeByRegex"

[[bind]]
path = "edit.select_edit.split"
name = "regex"
description = "Exclude all selections that contain a given regular expression"
key = "] r"
command = "selection-utilities.excludeByRegex"

[[path]]
id = "edit.action.symmetric"
name = "Symmetric Operations"
description = "Operations that occur at both ends of a selection"
default.kind = "select"
default.mode = "syminsert"

[[bind]]
path = "edit.action.symmetric"
name = "Symmetric Insert Mode"
description = """
In this mode all commands and character insertions happen at both ends of
the selection
"""
mode = "normal"
key = "g '"
command = "master-key.setMode"
args.value = "syminsert"

[[bind]]
path = "edit.action.symmetric"
name = "Normal"
description = "Return to normal model"
key = ["enter", "g '"]
command = "master-key.setMode"
mode = "syminsert"

[define.symmetric_key_map]
"shift+;" = ":"
"shift+'" = "\""
"shift+/" = "?"
"shift+\\" = "|"
"shift+=" = "+"
"shift+-" = "-"
"shift+8" = "*"
"shift+7" = "&"
"shift+6" = "^"
"shift+5" = "%"
"shift+4" = "$"
"shift+3" = "#"
"shift+2" = "@"
"shift+1" = "!"
"shift+`" = "~"
";" = ";"
"'" = "'"
"," = ","
"." = "."
"/" = "/"
"=" = "="
"-" = "-"
"`" = "`"

[[bind]]
path = "edit.action.symmetric"
key = [
      "shift+;",
      ";",
      "'",
      "shift+'",
      ",",
      ".",
      "/",
      "shift+/",
      "shift+\\",
      "=",
      "shift+=",
      "-",
      "shift+-",
      "shift+8",
      "shift+7",
      "shift+6",
      "shift+5",
      "shift+4",
      "shift+3",
      "shift+2",
      "shift+1",
      "shift+`",
      "`",
]
description = "Insert the character {symmetric_key_map[key]} at both ends of each selection"
command = "selection-utilities.insertAround"
args = { before = "{symmetric_key_map[key]}", after = "{symmetric_key_map[key]}" }
